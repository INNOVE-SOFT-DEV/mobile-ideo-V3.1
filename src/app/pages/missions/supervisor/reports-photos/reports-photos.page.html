<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="goBack()">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>

    <ion-title class="center-title">Rapport photos</ion-title>

    <ion-buttons slot="end">
      <ion-button>
        <ion-icon name="notifications-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="anumation-block cls-details" *ngIf="!isSliderOpen">

    <!-- Select -->
    <div class="anumation-block custom-select-container">
      <div class="anumation-block left">
        <span class="anumation-block selected-text">{{ selectedOption }}</span>
      </div>

      <div class="anumation-block right">
        <span class="anumation-block select-label">Select</span>
        <ion-icon
          name="chevron-down-outline"
          class="anumation-block select-icon">
        </ion-icon>
      </div>

      <select
        [(ngModel)]="selectedOption"
        (change)="onChange($event)"
        class="anumation-block select-native"
        name="select">
        <option value="Tous les agents">Tous les agents</option>
        <option
          *ngFor="let agent of team"
          [value]="agent?.full_name">
          {{ agent?.full_name }}
        </option>
      </select>
    </div>

    <!-- Tabs -->
    <div class="anumation-block custom-tab-container">
      <div class="anumation-block tabs">
        <div
          class="anumation-block tab"
          [class.active]="activeTab === 'prestation'"
          (click)="setActiveTab('prestation')">
          <ion-icon name="image-outline"></ion-icon>
          <span>Prestation</span>
        </div>

        <div
          class="anumation-block tab"
          [class.active]="activeTab === 'Camion'"
          (click)="setActiveTab('Camion')">
          <ion-icon name="car-outline"></ion-icon>
          <span>Camion</span>
        </div>
      </div>

      <div class="anumation-block tab-content">

        <!-- PRESTATION -->
        <div *ngIf="activeTab === 'prestation'">

          <ng-container *ngIf="images.length === 0">
            <div class="anumation-block empty-container">
              <img src="assets/img/emty-icon.png" />
              <p class="anumation-block cls-empty-title">
                {{ 'No data found' | translate }}
              </p>
              <p class="anumation-block cls-empty-d">
                {{ 'It appears that this list is currently empty' | translate }}
              </p>
            </div>
          </ng-container>

          <div class="anumation-block image-grid">
            <div
              class="anumation-block grid-item"
              *ngFor="let pair of images; let i = index">

              <div
                class="label"
                *ngIf="i === 0 || pair?.agent !== images[i - 1]?.agent">
                {{ pair?.agent }}
              </div>

              <div class="anumation-block image-pair">

                <div
                  class="anumation-block image-column"
                  *ngIf="pair?.before?.image_url?.url">
                  <img
                    [src]="pair.before.image_url.thumb"
                    alt="Before"
                    (click)="openSlides('photo_before', i)" />
                </div>

                <div
                  class="anumation-block image-column"
                  *ngIf="pair?.after?.image_url?.url">
                  <img
                    [src]="pair.after.image_url.thumb"
                    alt="After"
                    (click)="openSlides('photo_after', i)" />
                  <div class="anumation-block label">After</div>
                </div>

              </div>
            </div>
          </div>
        </div>

        <!-- CAMION -->
        <div *ngIf="activeTab === 'Camion'">

          <ng-container *ngIf="imagesCamions.length === 0">
            <div class="anumation-block empty-container">
              <img src="assets/img/emty-icon.png" />
              <p class="anumation-block cls-empty-title">
                {{ 'No data found' | translate }}
              </p>
              <p class="anumation-block cls-empty-d">
                {{ 'It appears that this list is currently empty' | translate }}
              </p>
            </div>
          </ng-container>

          <div class="anumation-block truck-grid">
            <div class="anumation-block camions-grid">
              <div
                class="anumation-block camion-item"
                *ngFor="let obj of imagesCamions; let i = index">
                <img
                  [src]="obj?.url"
                  alt="Camion"
                  (click)="openSlides('photo_truck', i)" />
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Buttons -->
    <div class="anumation-block btn-container">
      <ion-button
        class="anumation-block custom-button"
        expand="block"
        (click)="downloadZip()">
        <ion-img
          slot="start"
          class="anumation-block btn-icon"
          src="assets/img/Download.png">
        </ion-img>
        Télécharger les photos
      </ion-button>

      <ion-button
        class="anumation-block custom-button"
        expand="block"
        (click)="sendReport()">
        <ion-img
          slot="start"
          class="anumation-block btn-icon"
          src="assets/img/Navigation.png">
        </ion-img>
        Envoyez vers le client
      </ion-button>
    </div>

  </div>

  <app-glide
    *ngIf="isSliderOpen"
    [images]="sliderPhotos"
    [index]="initialIndexPhoto">
  </app-glide>
</ion-content>
