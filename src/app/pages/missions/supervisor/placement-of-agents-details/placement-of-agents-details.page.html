<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="goBack()">
        <ion-icon name="arrow-back-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="center-title">{{ 'Agent placement' | translate }}</ion-title>
    <ion-buttons slot="end">
      <ion-button>
        <ion-icon name="notifications-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="animate__animated animate__fadeInUp cls-supervisor">
    <div class="animate__animated animate__fadeInUp cards-list">
      <ion-grid>
        <ion-row class="animate__animated animate__fadeInUp ion-align-items-center ion-justify-content-between">
          <ion-col size="2" class="animate__animated animate__fadeInUp avatar-col">
            <img [src]="agentData?.user?.photo?.url || 'assets/img/avatar.png'" alt="Avatar" class="animate__animated animate__fadeInUp avatar-img" />
          </ion-col>
          <ion-col size="10" class="animate__animated animate__fadeInUp info-col">
            <ion-row class="animate__animated animate__fadeInUp name-row">{{ agentData?.user?.first_name + ' ' + agentData?.user?.last_name }}</ion-row>
            <ion-row class="animate__animated animate__fadeInUp missions-row">{{ agentData?.planning_punctuals }} {{ agentData?.planning_punctuals == 1 ? 'mission' : 'missions' }}</ion-row>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>
    <div class="animate__animated animate__fadeInUp date-display">{{ tommorrow }}</div>
  </div>

  <ion-card class="animate__animated animate__fadeInUp card pd-15" *ngFor="let planning of plannings">
    <ion-card-header class="animate__animated animate__fadeInUp card-header">
      <ion-card-title>
        <ion-grid>
          <ion-row>
            <ion-col size="9" push="3">
              <p class="animate__animated animate__fadeInUp name-campany">{{ planning.intervention_name }}</p>
            </ion-col>
            <ion-col class="animate__animated animate__fadeInUp logo" size="3" pull="9">
              <img class="animate__animated animate__fadeInUp logo" [src]="planning.logo?.url || 'assets/img/logo_pitch 5.png'" style="min-height: 54px" />
            </ion-col>
          </ion-row>
        </ion-grid>
        <ion-chip class="animate__animated animate__fadeInUp custom-chip">{{planning.prestation}}</ion-chip>
        <ion-row class="animate__animated animate__fadeInUp agent-row">
          <ion-col size="6" class="animate__animated animate__fadeInUp img-text-col">
            <div class="animate__animated animate__fadeInUp img-text-wrapper">
              <img src="assets/img/agent.png" alt="Agent" class="animate__animated animate__fadeInUp agent-img" />
              <span
                class="animate__animated animate__fadeInUp agents-text"
                [ngStyle]="{
  'color': planning.team.length>planning.agent_needed ? 'orange' :
             planning.team.length == planning.agent_needed ? 'green' : 'red'
                  
}"
              >
                {{ `${planning.team.length} / ${planning.agent_needed}`}}
              </span>
            </div>
          </ion-col>
          <ion-col size="6" class="animate__animated animate__fadeInUp chip-col">
            <div class="animate__animated animate__fadeInUp chip-custom">
              <ion-icon name="navigate-outline"></ion-icon>
              <span>{{calculateDistance(planning.lat , planning.long , agentData?.user?.lat , agentData?.user?.long ).toFixed(2 )}} km</span>
            </div>
          </ion-col>
        </ion-row>
      </ion-card-title>
    </ion-card-header>
  </ion-card>

  <div class="animate__animated animate__fadeInUp button-container" *ngIf="loadded == true">
    <button class="animate__animated animate__fadeInUp custom-button" (click)="placementOfAgentsAffect()">Ajouter une mission</button>
  </div>
</ion-content>
