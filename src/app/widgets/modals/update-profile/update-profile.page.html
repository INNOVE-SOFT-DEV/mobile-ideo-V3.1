<div class="modal-wrapper" [@backdropAnim]>
  <div class="modal-backdrop" (click)="dismiss()"></div>
  
  <div class="modal-content" [@modalAnim] (click)="$event.stopPropagation()">
    <!-- Modal Header -->
    <div class="modal-header">
      <h2 class="modal-title">Mettre à jour mon profil</h2>
      <button class="close-button" (click)="dismiss()">
        <ion-icon name="close-outline"></ion-icon>
      </button>
    </div>

    <!-- Modal Body -->
    <div class="modal-body">
      <!-- Avatar Upload Section -->
      <div class="avatar-upload-section" [@avatarSectionAnim]>
        <div class="avatar-container-modal" (click)="uploadProfilePic()">
          <div class="avatar-image-wrapper">
            <ion-img
              [src]="user?.photo_urls?.url ? user?.photo_urls?.url : 'assets/img/icone-pdf.png'"
              class="avatar-image-modal"
            ></ion-img>
          </div>
          <div class="camera-overlay">
            <ion-icon name="camera-outline"></ion-icon>
          </div>
        </div>
        <p class="avatar-hint">Clicker sur l'avatar pour le modifier</p>
      </div>

      <form [@formFieldsAnim] (ngSubmit)="saveProfile()">
        <!-- Phone -->
        <div class="form-field">
          <label class="form-label">Téléphone</label>
          <div class="input-wrapper">
            <ion-icon name="call-outline" class="input-icon"></ion-icon>
            <input
              type="tel"
              class="form-input"
              [(ngModel)]="phone"
              name="phone"
              [pattern]="phonePattern"
              (input)="blockChars($event)"
              placeholder="{{'Enter phone number' | translate}}"
              required
            />
          </div>
        </div>

         <div class="form-field">
          <label class="form-label">Mot de passe actuel</label>
          <div class="input-wrapper">
            <ion-icon name="lock-closed-outline" class="input-icon"></ion-icon>
            <input
              type="password"
              class="form-input"
              [(ngModel)]="currentPassword"
              name="currentPassword"
              placeholder="entrer votre mot de passe actuel"
                autocomplete ="off"

            />
          </div>
        </div>

        <!-- Password -->
        <div class="form-field">
          <label class="form-label">Mot de passe</label>
          <div class="input-wrapper">
            <ion-icon name="lock-closed-outline" class="input-icon"></ion-icon>
            <input
              type="password"
              class="form-input"
              [(ngModel)]="password"
              name="password"
              placeholder="entrer un nouveau mot de passe"
            />
          </div>
        </div>
        

        <!-- Action Buttons -->
        <div class="button-group">
          <button type="button" class="cancel-button" (click)="dismiss()" [disabled]="loading">
            {{'Cancel' | translate}}
          </button>
          <button type="submit" class="save-button" [disabled]="loading">
            <ion-spinner name="crescent" *ngIf="loading" class="button-spinner"></ion-spinner>
            <ion-icon name="checkmark-outline" *ngIf="!loading"></ion-icon>
            <span>{{loading ? ('Saving' | translate) : ('save' | translate)}}</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>