<ion-header class="modal-header">
  <ion-toolbar>
    <ion-title class="modal-title">Génerer un rapport photo</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismissModal()" class="close-button">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="modal-content">
  <ion-card *ngIf="showAlert" class="alert-card alert-danger">
    <ion-card-content>
      <ul class="alert-text">
        <li *ngFor="let message of alertMessages">{{ message }}</li>
      </ul>
      <ion-button fill="clear" size="small" (click)="dismissAlert()" class="alert-dismiss">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-card-content>
  </ion-card>

  <form [formGroup]="reportForm" class="report-form">
    <div class="form-section">
      <ion-radio-group [value]="reportForm.get('type_report')?.value" (ionChange)="onPhotoTypeChange($event)" class="photo-type-group">
        <div class="photo-options-row">
          <div class="photo-type-col">
            <ion-item class="radio-item">
              <ion-radio slot="start" value="prestation"></ion-radio>
              <ion-label>Prestation</ion-label>
            </ion-item>
          </div>
        </div>

        <div class="photo-options-row">
          <div class="photo-type-col">
            <ion-item class="radio-item">
              <ion-radio slot="start" value="truck"></ion-radio>
              <ion-label>Camion</ion-label>
            </ion-item>
          </div>
        </div>

        <div class="photo-options-row">
          <div class="photo-type-col">
            <ion-item class="radio-item">
              <ion-radio slot="start" value="constat"></ion-radio>
              <ion-label>Constat</ion-label>
            </ion-item>
          </div>
        </div>
      </ion-radio-group>
    </div>
    <div class="form-section">
      <ion-radio-group [value]="reportForm.get('type_report')?.value" (ionChange)="IncludesPhotosTruckChange($event)" class="photo-type-group">
        <div class="photo-options-row">
          <div class="checkbox-col">
            <ion-item class="checkbox-item">
              <ion-checkbox slot="start" formControlName="include_photo_camion"></ion-checkbox>
              <ion-label>Inclure photos Camion?</ion-label>
            </ion-item>
          </div>
        </div>
      </ion-radio-group>
      <ion-radio-group
        [value]="reportForm.get('type_report')?.value"
        (ionChange)="IncludesPhotosConstatChange($event)"
        class="photo-type-group"
        *ngIf="data?.planning_type == 'regular'"
      >
        <div class="photo-options-row">
          <div class="checkbox-col">
            <ion-item class="checkbox-item">
              <ion-checkbox slot="start" formControlName="include_photo_constat"></ion-checkbox>
              <ion-label>Inclure photos Constat?</ion-label>
            </ion-item>
          </div>
        </div>
      </ion-radio-group>
    </div>

    <div class="form-section">
      <ion-radio-group [value]="reportForm.get('type_report')?.value" (ionChange)="IncludesDatesChange($event)" class="photo-type-group">
        <ion-item class="checkbox-item">
          <ion-checkbox slot="start" formControlName="include_dates"></ion-checkbox>
          <ion-label>Les dates figuent sur la photo</ion-label>
        </ion-item>
      </ion-radio-group>
    </div>

    <div class="form-section report-section">
      <div class="section-title">Rapport:</div>
      <ion-radio-group [value]="reportForm.get('report')?.value" (ionChange)="onReportTypeChange($event)" class="report-radio-group">
        <div class="report-row">
          <ion-item class="radio-item">
            <ion-radio slot="start" value="ideo"></ion-radio>
            <ion-label>Ideo</ion-label>
          </ion-item>
          <ion-item class="radio-item">
            <ion-radio slot="start" value="nettopark"></ion-radio>
            <ion-label>NettoPark</ion-label>
          </ion-item>
        </div>
      </ion-radio-group>
    </div>

    <div class="form-section">
      <ion-item class="input-item">
        <ion-label position="stacked">Numéro de facture</ion-label>
        <ion-input type="text" formControlName="invoice_number" placeholder="Entrer le numéro de facture"></ion-input>
      </ion-item>
    </div>

    <div class="form-section">
      <ion-item class="textarea-item">
        <ion-label position="stacked">Message page de garde</ion-label>
        <ion-textarea formControlName="message" rows="4" placeholder="Entrer le message pour la page de garde"></ion-textarea>
      </ion-item>
    </div>
  </form>
</ion-content>

<ion-footer class="modal-footer">
  <ion-toolbar>
    <div class="footer-content">
      <div *ngIf="isLoading" class="loader-container">
        <ion-spinner name="crescent"></ion-spinner>
      </div>
      <div class="button-group" [class.disabled]="isLoading">
        <ion-button fill="solid" (click)="generatePublicReport()" [disabled]="isLoading" class="custom-button bg-mail">
          <span>Génerer le Rapport</span>
          <ion-icon name="document" slot="end"></ion-icon>
        </ion-button>
      </div>
    </div>
  </ion-toolbar>
</ion-footer>
