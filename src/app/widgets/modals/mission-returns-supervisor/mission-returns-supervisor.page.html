<ion-header>
  <ion-toolbar>
    <ion-title></ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">{{ 'Cancel' | translate }}</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="animate__animated animate__fadeInUp modal-content">
  <div class="animate__animated animate__fadeInUp center-container">
    <ion-card class="animate__animated animate__fadeInUp custom-card">
      <div class="animate__animated animate__fadeInUp card-container">
        <!-- Colonne gauche 75% -->
        <div class="animate__animated animate__fadeInUp left-col">
          <!-- Ligne 1 -->
          <div class="animate__animated animate__fadeInUp row row-1">
            <img [src]="planning?.intervention?.logos?.url || 'https://backend.ideogroupe.com/assets/img/default-company.png'" class="animate__animated animate__fadeInUp logo" />
            <span class="animate__animated animate__fadeInUp title">{{planning?.intervention?.name?.split('-')[0]}}</span>
          </div>

          <!-- Ligne 2 -->
          <div class="animate__animated animate__fadeInUp row row-2">
            <span class="animate__animated animate__fadeInUp address">{{ planning?.intervention?.name?.split('-')[1] }}</span>
          </div>

          <!-- Ligne 3 -->
          <div class="animate__animated animate__fadeInUp row row-3">
            <span class="animate__animated animate__fadeInUp date">{{planning?.today_schedule?.date}}</span>

            <ion-chip class="animate__animated animate__fadeInUp time-chip">
              <span class="animate__animated animate__fadeInUp time-text">{{returnTime}}</span>
            </ion-chip>
          </div>
        </div>

        <!-- Colonne droite 25% -->
        <div class="animate__animated animate__fadeInUp right-col">
          <img src="assets/img/img-55.png" class="animate__animated animate__fadeInUp icon" />
        </div>
      </div>
    </ion-card>

    <ion-card class="animate__animated animate__fadeInUp profile-card" *ngIf="audioUrl">
      <div class="animate__animated animate__fadeInUp card-inner">
        <!-- Colonne image 30% -->
        <div class="animate__animated animate__fadeInUp avatar-col">
          <img [src]="agent?.photo_urls?.thumb || 'assets/img/default-avatar.png'" class="animate__animated animate__fadeInUp avatar" />
        </div>

        <!-- Colonne texte -->
        <div class="animate__animated animate__fadeInUp info-col">
          <span class="animate__animated animate__fadeInUp name">{{agent?.first_name}} {{agent?.last_name}}</span>

          <ion-chip class="animate__animated animate__fadeInUp role-chip">
            <span class="animate__animated animate__fadeInUp role-text">{{agent?.role_name}}</span>
          </ion-chip>
        </div>
      </div>

      <div *ngIf="returnType?.indexOf('rescheduling') !== -1" class="animate__animated animate__fadeInUp replanification-block m-50 bg-FEFD99">
        <ion-icon name="calendar-clear-outline" class="animate__animated animate__fadeInUp agenda-icon"></ion-icon>
        <span class="animate__animated animate__fadeInUp replanification-text">{{ 'Replanification' | translate }}</span>
      </div>

      <div *ngIf="returnType?.indexOf('empty_truck') !== -1" class="animate__animated animate__fadeInUp replanification-block m-10 bg-CDF3FF">
        <ion-icon name="car-outline" class="animate__animated animate__fadeInUp agenda-icon"></ion-icon>
        <span class="animate__animated animate__fadeInUp replanification-text">{{ 'Truck to empty' | translate }}</span>
      </div>

      <div *ngIf="returnType?.indexOf('agent_absence') !== -1" class="animate__animated animate__fadeInUp replanification-block m-10 bg-D6BDFF">
        <ion-icon name="person-remove-outline" class="animate__animated animate__fadeInUp agenda-icon"></ion-icon>
        <span class="animate__animated animate__fadeInUp replanification-text">{{ 'Agent absence' | translate }}</span>
      </div>

      <div *ngIf="returnType?.indexOf('accident') !== -1" class="animate__animated animate__fadeInUp replanification-block m-10 bg-F4C5BA">
        <ion-icon name="medkit-outline" class="animate__animated animate__fadeInUp agenda-icon"></ion-icon>
        <span class="animate__animated animate__fadeInUp replanification-text">{{ 'Accident' | translate }}</span>
      </div>

      <div class="animate__animated animate__fadeInUp recording-card" *ngIf="audioUrl?.url?.includes('http')">
        <!-- Play / Pause -->
        <div class="animate__animated animate__fadeInUp play-btn" (click)="playRecordingAgain()">
          <ion-icon [name]="isPlaying ? 'pause' : 'play'"></ion-icon>
        </div>

        <!-- Timer -->
        <span class="animate__animated animate__fadeInUp record-time">{{ durationDisplay }}</span>

        <!-- Wave -->
        <div id="waveform"></div>

        <!-- Audio réel -->
      </div>
    </ion-card>

    <div class="animate__animated animate__fadeInUp feedback-container">
      <div class="animate__animated animate__fadeInUp feedback-btn" (click)="openFeedbackModal()">
        <span class="animate__animated animate__fadeInUp feedback-text">Faire un retour à l’agent</span>
      </div>
    </div>

    <!--
    <div class="animate__animated animate__fadeInUp center-title">
      <p class="animate__animated animate__fadeInUp cls-title">{{ 'Return mission' | translate }} 11</p> 
    </div>
    <p class="animate__animated animate__fadeInUp cls-label">{{ returnTime =='' ?('What type of feedback would you like to provide?' | translate ) : returnTime }}</p>
    <div class="animate__animated animate__fadeInUp replanification-block m-50" [ngClass]="returnType.indexOf('rescheduling') != -1  ? 'bg-FEFD99' : 'bg-FFFFFF'">
      <ion-icon name="calendar-clear-outline" class="animate__animated animate__fadeInUp agenda-icon"></ion-icon>
      <span class="animate__animated animate__fadeInUp replanification-text">{{ 'Replanification' | translate }}</span>
    </div>

    <div class="animate__animated animate__fadeInUp replanification-block m-10" [ngClass]="returnType.indexOf('empty_truck') != -1 ? 'bg-CDF3FF' : 'bg-FFFFFF'">
      <ion-icon name="car-outline" class="animate__animated animate__fadeInUp agenda-icon"></ion-icon>
      <span class="animate__animated animate__fadeInUp replanification-text">{{ 'Truck to empty' | translate }}</span>
    </div>

    <div class="animate__animated animate__fadeInUp replanification-block m-10" [ngClass]="returnType.indexOf('agent_absence') != -1 ? 'bg-D6BDFF' : 'bg-FFFFFF'">
      <ion-icon name="person-remove-outline" class="animate__animated animate__fadeInUp agenda-icon"></ion-icon>
      <span class="animate__animated animate__fadeInUp replanification-text">{{ 'Agent absence' | translate }}</span>
    </div>

    <div class="animate__animated animate__fadeInUp replanification-block m-10" [ngClass]="returnType.indexOf('accident') != -1 ? 'bg-F4C5BA' : 'bg-FFFFFF'">
      <ion-icon name="medkit-outline" class="animate__animated animate__fadeInUp agenda-icon"></ion-icon>
      <span class="animate__animated animate__fadeInUp replanification-text">{{ 'Accident' | translate }}</span>
    </div>

    <div class="animate__animated animate__fadeInUp vocal-card">
      <p class="animate__animated animate__fadeInUp vocal-card-title">{{ 'Record a voice' | translate }}</p>

      <div class="animate__animated animate__fadeInUp vocal-card-grid">
        <div class="animate__animated animate__fadeInUp vocal-badge" [ngClass]="important ? 'important' : 'not-important'">
          <ion-icon name="alert-circle-outline" class="animate__animated animate__fadeInUp badge-icon"></ion-icon>
          <span class="animate__animated animate__fadeInUp badge-text important-text">{{ 'Important' | translate }}</span>
        </div>
        <div class="animate__animated animate__fadeInUp vocal-badge" [ngClass]="!important ? 'important' : 'not-important'">
          <ion-icon name="information-circle-outline" class="animate__animated animate__fadeInUp badge-icon"></ion-icon>
          <span class="animate__animated animate__fadeInUp badge-text not-important-text">{{ 'Not Important' | translate }}</span>
        </div>
      </div>

      <div id="waveform"></div>
      <div *ngIf="audioUrl?.url?.includes('http')" class="animate__animated animate__fadeInUp cls-timer">{{ durationDisplay }}</div>

      <ion-button *ngIf="audioUrl" class="animate__animated animate__fadeInUp custom-button-update bg-record-lisen" (click)="playRecordingAgain()">
        <ion-icon name="play-circle-outline" slot="start"></ion-icon>
        {{ 'Listen to the recording again' | translate }}
      </ion-button>
    </div>
-->
  </div>
</ion-content>
