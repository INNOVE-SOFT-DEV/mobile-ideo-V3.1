<ion-header>
  <ion-toolbar>
    <ion-title></ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">{{'Cancel' | translate}}</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content class="modal-content">
  <div class="cls-supervisor">
    <p class="cls-title">{{ (absence.state =='pending' ?'Current requests': 'Requests processed' )| translate}}</p>
    <div class="border-solid-2"></div>
    <ion-card class="custom-card">
      <ion-card-content>
        <ion-item lines="full">
          <ion-label class="centered-title">{{absence?.user?.first_name}} {{absence?.user?.last_name}}</ion-label>
        </ion-item>

        <ion-item lines="full">
          <ion-icon name="calendar-outline"></ion-icon>
          <ion-label class="text-label">Jours</ion-label>
          <ion-label class="date-text">{{ absence?.date_start | date:'dd MMM' | uppercase }} - {{ absence?.date_end | date:'dd MMM' | uppercase }}</ion-label>
        </ion-item>
        <ion-item [lines]="absence?.document?.url == null ? 'none' : 'full'">
          <ion-icon name="document-outline"></ion-icon>
          <ion-label class="text-label">{{'Pattern' | translate}}</ion-label>
          <ion-chip *ngIf="absence?.type_absence == 'personal_reason'" class="chip rp">
            <p class="chip-text">{{'RP' | translate}}</p>
          </ion-chip>
          <ion-chip *ngIf="absence?.type_absence == 'rest'" class="chip repos">
            <p class="chip-text">{{'Rest' | translate}}</p>
          </ion-chip>
          <ion-chip *ngIf="absence?.type_absence == 'sick_day'" class="chip sick">
            <p class="chip-text">{{'Sick day' | translate}}</p>
          </ion-chip>
          <ion-chip *ngIf="absence?.type_absence == 'vacation'" class="chip leave">
            <p class="chip-text">{{'vacation' | translate}}</p>
          </ion-chip>
        </ion-item>

        <ion-item lines="none" *ngIf="absence?.document?.url != null">
          <ion-icon name="attach-outline"></ion-icon>
          <ion-label class="text-label">{{'Attachments' | translate}}</ion-label>
        </ion-item>

        <ng-container *ngIf="absence?.document?.url != null">
          <ion-item lines="none">
            <div class="custom-box">
              <ng-container *ngIf="imagePreview ==''  && !isPdf ">
                <ion-icon name="cloud-upload-outline" class="upload-icon"></ion-icon>
                <p class="upload-text">{{'Add a supporting document' | translate}}</p>
              </ng-container>
              <ng-container *ngIf="imagePreview !=''  || isPdf">
                <ion-img [src]="!isPdf ? imagePreview : 'assets/img/icone-pdf.png' "></ion-img>
              </ng-container>
            </div>
          </ion-item>
          <div class="cls-download-icon" (click)="previewDocument(absence.document.url)">
            <ion-icon class="download-icon" name="cloud-download-outline"></ion-icon>
          </div>
        </ng-container>
      </ion-card-content>
    </ion-card>

    <div class="btn-container" *ngIf="absence.state == 'pending'">
      <ion-button class="custom-button-update-cancel" (click)="changeAbsenceState('refused')">
        <ion-icon name="close-outline" *ngIf="!loadingReject"></ion-icon>
        <ion-spinner *ngIf="loadingReject" name="crescent"></ion-spinner>
        {{'Cancel' | translate}}
      </ion-button>
      <ion-button class="custom-button-update" (click)="changeAbsenceState('allowed')">
        <ion-icon *ngIf="!loadingAccept" name="checkmark-outline"></ion-icon>
        <ion-spinner *ngIf="loadingAccept" name="crescent"></ion-spinner>
        {{'To agree' | translate}}
      </ion-button>
    </div>
  </div>
</ion-content>
